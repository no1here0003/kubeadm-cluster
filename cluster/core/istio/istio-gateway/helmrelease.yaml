---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: istio-gateway
  namespace: istio-ingress
spec:
  dependsOn:
    - name: metallb
      namespace: metallb-system
  maxHistory: 3
  interval: 1m0s
  suspend: false
  releaseName: istio-gateway
  chart:
    spec:
      # renovate: registryUrl=https://istio-release.storage.googleapis.com/charts
      chart: gateways
      version: 1.14.1
      sourceRef:
        kind: HelmRepository
        name: istio-charts
        namespace: flux-system

  values:

    gateways:
      istio-ingressgateway:
        serviceAnnotations:
          metallb.universe.tf/loadBalancerIPs: ${SVC_INGRESS_ADDR}

    #     type: LoadBalancer

    # global:
    #   defaultConfigVisibilitySettings:
    #     - '*'

    #   arch:
    #     amd64: 2
    #     s390x: 0
    #     ppc64le: 0
    #     arm64: 2
